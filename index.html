<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Speech-to-Text Converter</title>

<style>
    body {
        margin: 0;
        font-family: 'Segoe UI', Arial, sans-serif;
        background: #eef2f7;
        color: #222;
    }
    header {
        background: #3b82f6;
        padding: 20px;
        text-align: center;
        color: white;
        font-size: 26px;
        font-weight: bold;
    }
    .container {
        width: 90%;
        max-width: 700px;
        margin: 30px auto;
        background: white;
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 4px 12px #00000020;
    }
    h2 {
        color: #3b82f6;
        font-size: 22px;
        margin-bottom: 10px;
    }
    button {
        background: #3b82f6;
        color: white;
        padding: 12px 20px;
        border: none;
        border-radius: 8px;
        font-size: 16px;
        cursor: pointer;
        margin: 8px;
    }
    button:hover {
        background: #1e61d6;
    }
    textarea {
        width: 100%;
        height: 220px;
        margin-top: 15px;
        padding: 15px;
        font-size: 16px;
        border-radius: 10px;
        border: 2px solid #d0d7e2;
    }
    input[type="file"] {
        margin-top: 10px;
        font-size: 16px;
    }
</style>
</head>

<body>

<header>Speech-to-Text Converter</header>

<div class="container">

    <h2>üé§ Real-Time Voice to Text</h2>
    <button onclick="startMic()">Start Recording</button>
    <button onclick="stopMic()">Stop Recording</button>

    <hr><br>

    <h2>üìÅ Upload Audio File ‚Üí Convert to Text</h2>
    <input type="file" id="audioFile" accept="audio/*"><br><br>
    <button onclick="convertAudio()">Convert Audio File</button>

    <textarea id="output" placeholder="Your text will appear here..."></textarea>

</div>

<script>
let recognition;
let recording = false;

// ---- Live Mic Recording ----
if ("webkitSpeechRecognition" in window) {
    recognition = new webkitSpeechRecognition();
    recognition.continuous = true;
    recognition.interimResults = true;
    recognition.lang = "en-US";

    recognition.onresult = event => {
        let text = "";
        for (let i = 0; i < event.results.length; i++) {
            text += event.results[i][0].transcript + " ";
        }
        document.getElementById("output").value = text;
    };
} else {
    alert("Your browser does not support Speech Recognition. Please use Chrome.");
}

function startMic() {
    if (!recording) {
        recognition.start();
        recording = true;
    }
}

function stopMic() {
    if (recording) {
        recognition.stop();
        recording = false;
    }
}

// ---- Audio File Conversion using OpenAI Whisper API ----
async function convertAudio() {
    const file = document.getElementById("audioFile").files[0];
    if (!file) {
        alert("Please select an audio file first.");
        return;
    }

    document.getElementById("output").value = "Converting audio... please wait.";

    // Prepare form data
    const formData = new FormData();
    formData.append("file", file);
    formData.append("model", "whisper-1"); // Whisper model

    try {
        const response = await fetch("https://api.openai.com/v1/audio/transcriptions", {
            method: "POST",
            headers: {
                "Authorization": "Bearer YOUR_OPENAI_API_KEY"
            },
            body: formData
        });

        const data = await response.json();
        document.getElementById("output").value = data.text;
    } catch (err) {
        console.error(err);
        alert("Error converting audio. Check your API key and internet connection.");
    }
}
</script>

</body>
</html>